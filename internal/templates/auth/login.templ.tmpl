package views

import (
	"[[.ModulePath]]/internal/web/components"
)

// LoginProps contains props for the login page.
type LoginProps struct {
	Email  string
	Error  string
	Errors map[string]string
}

// LoginPage renders the login page.
templ LoginPage(props LoginProps) {
	@AuthLayout("Login") {
		@components.Card(components.CardProps{Class: "w-full max-w-md"}) {
			@components.CardHeader("text-center") {
				<h1 class="text-2xl font-bold text-gray-900 dark:text-white">Welcome back</h1>
				<p class="mt-2 text-sm text-gray-600 dark:text-gray-400">
					Sign in to your account to continue
				</p>
			}
			@components.CardContent("") {
				if props.Error != "" {
					<div class="mb-4 p-3 bg-red-50 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-lg">
						<p class="text-sm text-red-600 dark:text-red-400">{ props.Error }</p>
					</div>
				}
				<form hx-post="/login" hx-target="body" class="space-y-4">
					<!-- Email -->
					<div class="space-y-2">
						@components.Label("email", true) {
							Email
						}
						@components.Input(components.InputProps{
							ID:          "email",
							Name:        "email",
							Type:        "email",
							Placeholder: "you@example.com",
							Required:    true,
							Value:       props.Email,
							Error:       props.Errors["email"],
							Attributes: templ.Attributes{
								"autocomplete": "email",
							},
						})
						@components.FormError(props.Errors["email"])
					</div>

					<!-- Password -->
					<div class="space-y-2">
						<div class="flex items-center justify-between">
							@components.Label("password", true) {
								Password
							}
							<a href="/forgot-password" class="text-sm text-blue-600 hover:text-blue-500">
								Forgot password?
							</a>
						</div>
						@components.Input(components.InputProps{
							ID:          "password",
							Name:        "password",
							Type:        "password",
							Placeholder: "Enter your password",
							Required:    true,
							Error:       props.Errors["password"],
							Attributes: templ.Attributes{
								"autocomplete": "current-password",
							},
						})
						@components.FormError(props.Errors["password"])
					</div>

					<!-- Remember Me -->
					<div class="flex items-center gap-2">
						@components.Checkbox("remember", "remember", "true", false, false, nil)
						<label for="remember" class="text-sm text-gray-600 dark:text-gray-400">
							Remember me for 30 days
						</label>
					</div>

					<!-- Submit -->
					@components.Button(components.ButtonProps{
						Type:    "submit",
						Variant: "default",
						Class:   "w-full",
					}) {
						Sign in
					}
				</form>
			}
			@components.CardFooter("text-center") {
				<p class="text-sm text-gray-600 dark:text-gray-400">
					Don't have an account?
					<a href="/register" class="text-blue-600 hover:text-blue-500 font-medium">
						Sign up
					</a>
				</p>
			}
		}
	}
}

// LoginForm renders just the login form for HTMX updates.
templ LoginForm(props LoginProps) {
	@LoginPage(props)
}
