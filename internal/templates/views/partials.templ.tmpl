package views

import (
	"[[.ModulePath]]/internal/models"
	"github.com/templui/templui/components/button"
	"github.com/templui/templui/components/icon"
	"github.com/templui/templui/components/badge"
)

// [[.ModelName]]Row renders a list row for a [[.ModelName]].
templ [[.ModelName]]Row(item models.[[.ModelName]]) {
	<div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
		<div class="flex items-center gap-4">
			<div>
				<h3 class="font-medium text-gray-900 dark:text-white">
					[[- range $i, $f := .Fields]]
					[[- if eq $i 0]]
					{ [[if eq $f.Type "string"]]item.[[.Name]][[else]]fmt.Sprintf("%v", item.[[.Name]])[[end]] }
					[[- end]]
					[[- end]]
				</h3>
				<p class="text-sm text-gray-500 dark:text-gray-400">
					ID: { fmt.Sprintf("%d", item.ID) }
				</p>
			</div>
		</div>
		<div class="flex items-center gap-2">
			@button.Button(button.Props{
				Variant: "ghost",
				Size:    "sm",
				Attributes: templ.Attributes{
					"hx-get":      fmt.Sprintf("[[.URLPath]]/%d", item.ID),
					"hx-target":   "#main-content",
					"hx-push-url": "true",
				},
			}) {
				View
			}
			@button.Button(button.Props{
				Variant: "ghost",
				Size:    "sm",
				Attributes: templ.Attributes{
					"hx-get":    fmt.Sprintf("[[.URLPath]]/%d/edit", item.ID),
					"hx-target": "#modal-container",
					"hx-swap":   "innerHTML",
				},
			}) {
				Edit
			}
		</div>
	</div>
}

// [[.ModelName]]Badge renders a badge for a [[.ModelName]] field.
templ [[.ModelName]]Badge(value string, variant string) {
	@badge.Badge(badge.Props{Variant: badge.Variant(variant)}) {
		{ value }
	}
}

// [[.ModelName]]SuccessMessage renders a success message after an action.
templ [[.ModelName]]SuccessMessage(message string) {
	<div
		class="fixed bottom-4 right-4 z-50 flex items-center gap-2 bg-green-500 text-white px-4 py-3 rounded-lg shadow-lg"
		_="on load wait 3s then transition opacity to 0 over 300ms then remove me"
	>
		@icon.Icon(icon.Props{Name: "check-circle", Class: "h-5 w-5"})
		<span>{ message }</span>
	</div>
}

// [[.ModelName]]ErrorMessage renders an error message.
templ [[.ModelName]]ErrorMessage(message string) {
	<div
		class="fixed bottom-4 right-4 z-50 flex items-center gap-2 bg-red-500 text-white px-4 py-3 rounded-lg shadow-lg"
		_="on load wait 5s then transition opacity to 0 over 300ms then remove me"
	>
		@icon.Icon(icon.Props{Name: "x-circle", Class: "h-5 w-5"})
		<span>{ message }</span>
	</div>
}

// [[.ModelName]]DeletedRow renders a placeholder for a deleted row (for HTMX swap animation).
templ [[.ModelName]]DeletedRow() {
	<div
		class="p-4 text-center text-gray-500 dark:text-gray-400 bg-red-50 dark:bg-red-900/20"
		_="on load wait 300ms then remove me"
	>
		Item deleted
	</div>
}

// [[.ModelName]]LoadingSpinner renders a loading spinner.
templ [[.ModelName]]LoadingSpinner() {
	<div class="flex items-center justify-center p-8">
		<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"></div>
	</div>
}

// [[.ModelName]]Skeleton renders a skeleton loading state.
templ [[.ModelName]]Skeleton() {
	<div class="animate-pulse space-y-4">
		<div class="h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4"></div>
		<div class="space-y-3">
			<div class="h-4 bg-gray-200 dark:bg-gray-700 rounded"></div>
			<div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-5/6"></div>
			<div class="h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/6"></div>
		</div>
	</div>
}

// [[.ModelName]]ConfirmDelete renders a delete confirmation dialog.
templ [[.ModelName]]ConfirmDelete(item models.[[.ModelName]]) {
	<div class="fixed inset-0 z-50 flex items-center justify-center bg-black/50"
		 _="on click if event.target === me remove me">
		<div class="bg-white dark:bg-gray-900 rounded-lg shadow-xl p-6 max-w-md mx-4">
			<div class="flex items-center gap-4">
				<div class="flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/50 flex items-center justify-center">
					@icon.Icon(icon.Props{Name: "alert-triangle", Class: "h-6 w-6 text-red-600"})
				</div>
				<div>
					<h3 class="text-lg font-medium text-gray-900 dark:text-white">Delete [[.ModelName]]</h3>
					<p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
						Are you sure you want to delete this [[.ModelName | toLower]]? This action cannot be undone.
					</p>
				</div>
			</div>
			<div class="mt-6 flex justify-end gap-3">
				@button.Button(button.Props{
					Variant: "outline",
					Attributes: templ.Attributes{
						"_": "on click remove closest .fixed",
					},
				}) {
					Cancel
				}
				@button.Button(button.Props{
					Variant: "destructive",
					Attributes: templ.Attributes{
						"hx-delete": fmt.Sprintf("[[.URLPath]]/%d", item.ID),
						"hx-target": "#main-content",
						"hx-swap":   "innerHTML",
					},
				}) {
					Delete
				}
			</div>
		</div>
	</div>
}

// [[.ModelName]]InfoRow renders a key-value info row.
templ [[.ModelName]]InfoRow(label string, value string) {
	<div class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-800">
		<dt class="text-sm text-gray-500 dark:text-gray-400">{ label }</dt>
		<dd class="text-sm font-medium text-gray-900 dark:text-white">{ value }</dd>
	</div>
}
