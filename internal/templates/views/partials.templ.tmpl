package views

import (
	"fmt"

	"[[.ModulePath]]/internal/models"
	"[[.ModulePath]]/internal/web/components"
)

// [[.ModelName]]Row renders a list row for a [[.ModelName]].
templ [[.ModelName]]Row(item models.[[.ModelName]]) {
	<div class="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors">
		<div class="flex items-center gap-4">
			<div>
				<h3 class="font-medium text-gray-900 dark:text-white">
					[[- range $i, $f := .Fields]]
					[[- if eq $i 0]]
					{ [[if eq $f.Type "string"]]item.[[.Name]][[else]]fmt.Sprintf("%v", item.[[.Name]])[[end]] }
					[[- end]]
					[[- end]]
				</h3>
				<p class="text-sm text-gray-500 dark:text-gray-400">
					ID: { fmt.Sprintf("%d", item.ID) }
				</p>
			</div>
		</div>
		<div class="flex items-center gap-2">
			@components.Button(components.ButtonProps{
				Variant: "ghost",
				Size:    "sm",
				Attributes: templ.Attributes{
					"hx-get":      fmt.Sprintf("[[.URLPath]]/%d", item.ID),
					"hx-target":   "#main-content",
					"hx-push-url": "true",
				},
			}) {
				View
			}
			@components.Button(components.ButtonProps{
				Variant: "ghost",
				Size:    "sm",
				Attributes: templ.Attributes{
					"hx-get":    fmt.Sprintf("[[.URLPath]]/%d/edit", item.ID),
					"hx-target": "#modal-container",
					"hx-swap":   "innerHTML",
				},
			}) {
				Edit
			}
		</div>
	</div>
}

// [[.ModelName]]Badge renders a badge for a [[.ModelName]] field.
templ [[.ModelName]]Badge(value string, variant string) {
	@components.Badge(components.BadgeProps{Variant: variant}) {
		{ value }
	}
}

// [[.ModelName]]SuccessMessage renders a success message after an action.
templ [[.ModelName]]SuccessMessage(message string) {
	@components.Toast(message, "success")
}

// [[.ModelName]]ErrorMessage renders an error message.
templ [[.ModelName]]ErrorMessage(message string) {
	@components.Toast(message, "error")
}

// [[.ModelName]]DeletedRow renders a placeholder for a deleted row (for HTMX swap animation).
templ [[.ModelName]]DeletedRow() {
	<div
		class="p-4 text-center text-gray-500 dark:text-gray-400 bg-red-50 dark:bg-red-900/20"
		_="on load wait 300ms then remove me"
	>
		Item deleted
	</div>
}

// [[.ModelName]]LoadingSpinner renders a loading spinner.
templ [[.ModelName]]LoadingSpinner() {
	@components.LoadingSpinner()
}

// [[.ModelName]]Skeleton renders a skeleton loading state.
templ [[.ModelName]]Skeleton() {
	@components.SkeletonText(4)
}

// [[.ModelName]]ConfirmDelete renders a delete confirmation dialog.
templ [[.ModelName]]ConfirmDelete(item models.[[.ModelName]]) {
	@components.ModalBackdrop() {
		@components.ModalDialog("md") {
			<div class="p-6">
				<div class="flex items-start gap-4">
					<div class="flex-shrink-0 w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/50 flex items-center justify-center">
						@components.Icon("alert-triangle", "h-6 w-6 text-red-600")
					</div>
					<div>
						<h3 class="text-lg font-medium text-gray-900 dark:text-white">Delete [[.ModelName]]</h3>
						<p class="mt-1 text-sm text-gray-500 dark:text-gray-400">
							Are you sure you want to delete this [[.ModelName | toLower]]? This action cannot be undone.
						</p>
					</div>
				</div>
			</div>
			<div class="flex justify-end gap-3 p-4 border-t border-gray-200 dark:border-gray-700">
				@components.Button(components.ButtonProps{
					Variant: "outline",
					Attributes: templ.Attributes{
						"_": "on click remove closest .fixed",
					},
				}) {
					Cancel
				}
				@components.Button(components.ButtonProps{
					Variant: "destructive",
					Attributes: templ.Attributes{
						"hx-delete": fmt.Sprintf("[[.URLPath]]/%d", item.ID),
						"hx-target": "#main-content",
						"hx-swap":   "innerHTML",
					},
				}) {
					Delete
				}
			</div>
		}
	}
}

// [[.ModelName]]InfoRow renders a key-value info row.
templ [[.ModelName]]InfoRow(label string, value string) {
	<div class="flex justify-between py-2 border-b border-gray-100 dark:border-gray-800">
		<dt class="text-sm text-gray-500 dark:text-gray-400">{ label }</dt>
		<dd class="text-sm font-medium text-gray-900 dark:text-white">{ value }</dd>
	</div>
}
