package layouts

templ Base(title string) {
	<!DOCTYPE html>
	<html lang="en" class="h-full">
		<head>
			<meta charset="UTF-8"/>
			<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
			<title>{ title } - [[.ProjectName]]</title>
			<script src="https://unpkg.com/htmx.org@2.0.0"></script>
			<script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
			<link href="/assets/css/output.css" rel="stylesheet"/>
		</head>
		<body class="h-full bg-background text-foreground" hx-boost="true">
			<div id="app" class="min-h-full">
				{ children... }
			</div>
			<!-- Toast container -->
			<div id="toast-container" class="fixed top-4 right-4 z-50 space-y-2"></div>
			<!-- Modal container -->
			<div id="modal-container"></div>
			<script>
				// Toast notification handler
				document.body.addEventListener('showToast', function(evt) {
					const toast = document.createElement('div');
					const type = evt.detail.type || 'info';
					const colors = {
						success: 'bg-green-500',
						error: 'bg-red-500',
						warning: 'bg-yellow-500',
						info: 'bg-blue-500'
					};
					toast.className = `${colors[type]} text-white px-4 py-2 rounded shadow-lg`;
					toast.textContent = evt.detail.message;
					document.getElementById('toast-container').appendChild(toast);
					setTimeout(() => toast.remove(), 3000);
				});
			</script>
		</body>
	</html>
}

// Dashboard renders a dashboard layout with children (for use in templ files).
// For composing from Go code, use DashboardPage instead.
templ Dashboard(title string) {
	@Base(title) {
		<div class="flex h-full">
			<!-- Sidebar -->
			<aside class="w-64 bg-card border-r hidden md:block">
				<div class="p-4">
					<h1 class="text-xl font-bold">[[.ProjectName]]</h1>
				</div>
				<nav id="sidebar-nav" class="p-4">
					<!-- Navigation loaded from menu config -->
				</nav>
			</aside>
			<!-- Main content -->
			<main class="flex-1 overflow-auto">
				<div id="main-content" class="p-6">
					{ children... }
				</div>
			</main>
		</div>
	}
}

// DashboardPage renders a dashboard layout with content passed as a component.
// This is designed for easy composition from Go controller code.
//
// Example usage in a controller:
//
//	res.RenderWithLayout(
//	    func(c templ.Component) templ.Component {
//	        return layouts.DashboardPage("Users", c)
//	    },
//	    views.UserList(props),
//	)
//
// Or using the simpler pattern:
//
//	res.Render(layouts.DashboardPage("Users", views.UserList(props)))
templ DashboardPage(title string, content templ.Component) {
	@Base(title) {
		<div class="flex h-full">
			<!-- Sidebar -->
			<aside class="w-64 bg-card border-r hidden md:block">
				<div class="p-4">
					<h1 class="text-xl font-bold">[[.ProjectName]]</h1>
				</div>
				<nav id="sidebar-nav" class="p-4">
					<!-- Navigation loaded from menu config -->
				</nav>
			</aside>
			<!-- Main content -->
			<main class="flex-1 overflow-auto">
				<div id="main-content" class="p-6">
					@content
				</div>
			</main>
		</div>
	}
}

// BasePage renders a base layout with content passed as a component.
// Similar to DashboardPage but without the sidebar.
templ BasePage(title string, content templ.Component) {
	@Base(title) {
		<div id="main-content">
			@content
		</div>
	}
}
